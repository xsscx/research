diff --git a/Tools/CmdLine/IccApplyProfiles/TiffImg.cpp b/Tools/CmdLine/IccApplyProfiles/TiffImg.cpp
index c8dd391..249860c 100644
--- a/Tools/CmdLine/IccApplyProfiles/TiffImg.cpp
+++ b/Tools/CmdLine/IccApplyProfiles/TiffImg.cpp
@@ -221,7 +221,11 @@ bool CTiffImg::Create(const char *szFname, unsigned int nWidth, unsigned int nHe
     }
     m_nBytesPerLine = m_nWidth * m_nBytesPerSample * m_nSamples;
 
-    m_pStripBuf = (unsigned char*)malloc(m_nStripSize*m_nStripSamples);
+    if (m_nStripSamples && m_nStripSize > SIZE_MAX / m_nStripSamples) {
+      Close();
+      return false;
+    }
+    m_pStripBuf = (unsigned char*)malloc((size_t)m_nStripSize * m_nStripSamples);
 
     if (!m_pStripBuf) {
       Close();
@@ -312,7 +316,11 @@ bool CTiffImg::Open(const char *szFname)
     m_nBytesPerLine = (m_nWidth * m_nBitsPerSample * m_nSamples + 7)>>3;
   }
 
-  m_pStripBuf = (unsigned char*)malloc(m_nStripSize*m_nStripSamples);
+  if (m_nStripSamples && m_nStripSize > SIZE_MAX / m_nStripSamples) {
+    Close();
+    return false;
+  }
+  m_pStripBuf = (unsigned char*)malloc((size_t)m_nStripSize * m_nStripSamples);
 
   if (!m_pStripBuf) {
     Close();
