diff --git a/IccProfLib/IccTagBasic.cpp b/IccProfLib/IccTagBasic.cpp
index bb5c226..b0184cc 100644
--- a/IccProfLib/IccTagBasic.cpp
+++ b/IccProfLib/IccTagBasic.cpp
@@ -2851,6 +2851,10 @@ bool CIccTagNamedColor2::SetSize(icUInt32Number nSize, icInt32Number nDeviceCoor
   if (nDeviceCoords<0)
     nDeviceCoords = m_nDeviceCoords;
 
+  // CFL patch 011: cap NamedColor2 allocation to 128 MB to prevent OOM
+  if ((icUInt64Number)nSize * (32 + 4 * sizeof(icFloatNumber)) > 134217728ULL)
+    return false;
+
   icInt32Number nNewCoords=nDeviceCoords;
 
   if (nDeviceCoords>0)
@@ -3762,6 +3766,10 @@ bool CIccTagXYZ::SetSize(icUInt32Number nSize, bool bZeroNew/*=true*/)
   if (nSize==m_nSize)
     return true;
 
+  // CFL patch 011: cap XYZ allocation to 128 MB to prevent OOM
+  if ((icUInt64Number)nSize * sizeof(icXYZNumber) > 134217728ULL)
+    return false;
+
   m_XYZ = (icXYZNumber*)icRealloc(m_XYZ, nSize*sizeof(icXYZNumber));
 
   if (!m_XYZ) {
@@ -5479,6 +5487,10 @@ bool CIccTagFixedNum<T, Tsig>::SetSize(icUInt32Number nSize, bool bZeroNew/*=tru
   if (nSize==m_nSize)
     return true;
 
+  // CFL patch 011: cap FixedNum allocation to 128 MB to prevent OOM
+  if ((icUInt64Number)nSize * sizeof(T) > 134217728ULL)
+    return false;
+
   m_Num = (T*)icRealloc(m_Num, nSize*sizeof(T));
 
   if (!m_Num) {
@@ -6042,6 +6054,10 @@ bool CIccTagNum<T, Tsig>::SetSize(icUInt32Number nSize, bool bZeroNew/*=true*/)
   if (nSize==m_nSize)
     return true;
 
+  // CFL patch 011: cap TagNum allocation to 128 MB to prevent OOM
+  if ((icUInt64Number)nSize * sizeof(T) > 134217728ULL)
+    return false;
+
   m_Num = (T*)icRealloc(m_Num, nSize*sizeof(T));
 
   if (!m_Num) {
@@ -6614,6 +6630,10 @@ bool  CIccTagFloatNum<T, Tsig>::SetSize(icUInt32Number nSize, bool bZeroNew/*=tr
   if (nSize==m_nSize)
     return true;
 
+  // CFL patch 011: cap FloatNum allocation to 128 MB to prevent OOM
+  if ((icUInt64Number)nSize * sizeof(T) > 134217728ULL)
+    return false;
+
   m_Num = (T*)icRealloc(m_Num, nSize*sizeof(T));
 
   if (!m_Num) {
