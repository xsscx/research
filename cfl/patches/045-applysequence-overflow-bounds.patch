diff --git a/IccProfLib/IccMpeCalc.cpp b/IccProfLib/IccMpeCalc.cpp
index b8d6159..289e401 100644
--- a/IccProfLib/IccMpeCalc.cpp
+++ b/IccProfLib/IccMpeCalc.cpp
@@ -3720,27 +3720,26 @@ bool CIccCalculatorFunc::ApplySequence(CIccApplyMpeCalculator *pApply, icUInt32N
 
       if (os.idx+1<nOps && ops[os.idx+1].sig==icSigElseOp) {
         os.idx++;
-        if (a1>=0.5) {
-          if (os.idx+1 + op->data.size >= nOps)
-            return false;
+        // CFL patch: use 64-bit arithmetic to prevent uint32 overflow in bounds checks;
+        // validate both if and else block sizes regardless of which branch is taken
+        if ((icUInt64Number)os.idx+1 + op->data.size + (icUInt64Number)ops[os.idx].data.size > nOps)
+          return false;
 
+        if (a1>=0.5) {
           if (!ApplySequence(pApply, op->data.size, &ops[os.idx+1]))
             return false;
         }
         else {
-          if (os.idx+1 + op->data.size + ops[os.idx].data.size > nOps)
-            return false;
-
           if (!ApplySequence(pApply, ops[os.idx].data.size, &ops[os.idx+1 + op->data.size]))
             return false;
         }
         os.idx += op->data.size + ops[os.idx].data.size;
       }
       else {
-        if (a1>=0.5) {
-          if (os.idx+op->data.size >= nOps)
-            return false;
+        if ((icUInt64Number)os.idx + op->data.size >= nOps)
+          return false;
 
+        if (a1>=0.5) {
           if (!ApplySequence(pApply, op->data.size, &ops[os.idx+1]))
             return false;
         }
@@ -3764,17 +3763,19 @@ bool CIccCalculatorFunc::ApplySequence(CIccApplyMpeCalculator *pApply, icUInt32N
         return false;
       }
       
-      icUInt32Number nDefOff = (icUInt32Number)(os.idx+1 + op->extra);
-      if (nDefOff >= nOps)
+      // CFL patch: use 64-bit arithmetic to prevent uint32 overflow in bounds checks
+      icUInt64Number nDefOff64 = (icUInt64Number)os.idx + 1 + op->extra;
+      if (nDefOff64 >= nOps)
         return false;
+      icUInt32Number nDefOff = (icUInt32Number)nDefOff64;
 
       if (nSel<0 || (icUInt32Number)nSel>=op->extra) {
 
         if (ops[nDefOff].sig==icSigDefaultOp) {
-          if (os.idx+1 + ops[nDefOff].extra >= nOps)
+          if ((icUInt64Number)os.idx+1 + ops[nDefOff].extra >= nOps)
             return false;
 
-          if (os.idx+1 + ops[nDefOff].extra + ops[nDefOff].data.size > nOps)
+          if ((icUInt64Number)os.idx+1 + ops[nDefOff].extra + ops[nDefOff].data.size > nOps)
             return false;
 
           if (!ApplySequence(pApply, ops[nDefOff].data.size, &ops[os.idx+1 + ops[nDefOff].extra]))
@@ -3782,12 +3783,13 @@ bool CIccCalculatorFunc::ApplySequence(CIccApplyMpeCalculator *pApply, icUInt32N
         }
       }
       else {
-        icUInt32Number nOff = os.idx+1 + nSel;
+        icUInt64Number nOff64 = (icUInt64Number)os.idx + 1 + nSel;
 
-        if (nOff >= nOps) 
+        if (nOff64 >= nOps) 
           return false;
+        icUInt32Number nOff = (icUInt32Number)nOff64;
 
-        if (os.idx+1 + ops[nOff].extra + ops[nOff].data.size > nOps)
+        if ((icUInt64Number)os.idx+1 + ops[nOff].extra + ops[nOff].data.size > nOps)
           return false;
 
         if (!ApplySequence(pApply, ops[nOff].data.size, &ops[os.idx+1 + ops[nOff].extra]))
@@ -3795,18 +3797,19 @@ bool CIccCalculatorFunc::ApplySequence(CIccApplyMpeCalculator *pApply, icUInt32N
       }
 
       if (ops[nDefOff].sig==icSigDefaultOp) {
-        if (os.idx+1 + ops[nDefOff].extra + ops[nDefOff].data.size >nOps)
+        if ((icUInt64Number)os.idx+1 + ops[nDefOff].extra + ops[nDefOff].data.size > nOps)
           return false;
 
         os.idx = (icUInt32Number)(os.idx + ops[nDefOff].extra + ops[nDefOff].data.size);
       }
       else if (op->extra) {
-        unsigned long nOff = os.idx + op->extra;
+        icUInt64Number nOff64 = (icUInt64Number)os.idx + op->extra;
 
-        if (nOff >= nOps)
+        if (nOff64 >= nOps)
           return false;
+        icUInt32Number nOff = (icUInt32Number)nOff64;
 
-        if (os.idx+1 + ops[nOff].extra + ops[nOff].data.size > nOps)
+        if ((icUInt64Number)os.idx+1 + ops[nOff].extra + ops[nOff].data.size > nOps)
           return false;
 
         os.idx = (icUInt32Number)(os.idx + ops[nOff].extra + ops[nOff].data.size);
