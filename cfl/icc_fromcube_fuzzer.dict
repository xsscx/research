# icc_fromcube_fuzzer dictionary — high-signal tokens for .cube LUT format
# Targets all parser branches in CubeFile (iccFromCube.cpp)
#
# Parser flow: parseHeader() → parse3DTable() → ICC profile construction
# Key coverage targets:
#   - Header keyword dispatch (TITLE, LUT_3D_SIZE, DOMAIN_MIN/MAX, etc.)
#   - Empty-line / blank-line / comment handling
#   - getTitle() quoted vs unquoted paths
#   - getNext() whitespace-delimited value parsing
#   - parse3DTable() triplet parsing, comment skipping
#   - Integer overflow in LUT_3D_SIZE (atoll path)
#   - Custom input range → curve sharing logic (per-channel match/mismatch)

# ═══════════════════════════════════════════════════════════════════
# SECTION 1: Header keywords (exact match required by substr())
# ═══════════════════════════════════════════════════════════════════
"TITLE "
"LUT_3D_SIZE "
"LUT_1D_SiZE "
"DOMAIN_MIN "
"DOMAIN_MAX "
"LUT_3D_INPUT_RANGE "
"LUT_IN_VIDEO_RANGE"
"LUT_OUT_VIDEO_RANGE"

# ═══════════════════════════════════════════════════════════════════
# SECTION 2: LUT sizes — exercise atoll() + INT_MAX/<=0 validation
# ═══════════════════════════════════════════════════════════════════
# Valid sizes (parse3DTable requires >= 2)
"2"
"3"
"4"
"5"
"8"
"9"
"16"
"17"
"32"
"33"
"64"
"65"
# Boundary: size=1 rejected by parse3DTable (< 2)
"1"
# Boundary: size=0 rejected by atoll check (<= 0)
"0"
# Large sizes (uint64_t overflow in s*s*s: 1291^3 > UINT_MAX)
"1290"
"1291"
"1292"
"2000"
# Negative size rejected by atoll check (<= 0)
"-1"
"-2"
# INT_MAX overflow via atoll
"2147483647"
"2147483648"
"9999999999999"

# ═══════════════════════════════════════════════════════════════════
# SECTION 3: Float values — exercise atof() in DOMAIN and LUT data
# ═══════════════════════════════════════════════════════════════════
# Standard range
"0.0"
"1.0"
"0.5"
"0.25"
"0.75"
# Non-standard ranges (triggers isCustomInputRange)
"-1.0"
"-0.5"
"2.0"
"1.5"
"3.0"
"100.0"
"-100.0"
# Edge-case floats
"0.0000001"
"0.9999999"
"1e10"
"1e-10"
"-1e38"
"1e38"
"inf"
"-inf"
"nan"
"NaN"

# ═══════════════════════════════════════════════════════════════════
# SECTION 4: Float triplets — exercise parse3DTable() row parsing
# ═══════════════════════════════════════════════════════════════════
"0.0 0.0 0.0"
"1.0 1.0 1.0"
"0.5 0.5 0.5"
"0.0 0.5 1.0"
"1.0 0.0 0.5"
"0.25 0.75 0.5"
"-1.0 2.0 0.0"

# ═══════════════════════════════════════════════════════════════════
# SECTION 5: Per-channel DOMAIN values — exercise curve sharing logic
# ═══════════════════════════════════════════════════════════════════
# Uniform range (all channels same → curves shared)
"DOMAIN_MIN 0.0"
"DOMAIN_MAX 1.0"
# Per-channel with 1 value (fallback: all channels = same)
"DOMAIN_MIN -1.0"
"DOMAIN_MAX 2.0"
# Per-channel with 2 values (ch2 = ch1 fallback)
"DOMAIN_MIN 0.0 0.5"
"DOMAIN_MAX 1.0 2.0"
# Per-channel with 3 values (all independent → 3 separate curves)
"DOMAIN_MIN 0.0 0.5 1.0"
"DOMAIN_MAX 1.0 2.0 3.0"
# Channels match ch0 (pCurve1=pCurve0, pCurve2=pCurve0)
"DOMAIN_MIN 0.5 0.5 0.5"
"DOMAIN_MAX 2.0 2.0 2.0"
# Ch1 differs, ch2 matches ch1 (pCurve2=pCurve1)
"DOMAIN_MIN 0.0 0.5 0.5"
"DOMAIN_MAX 1.0 2.0 2.0"
# Ch1 matches ch0, ch2 differs (pCurve1=pCurve0, new pCurve2)
"DOMAIN_MIN 0.0 0.0 0.5"
"DOMAIN_MAX 1.0 1.0 2.0"
# All three different (new pCurve1, new pCurve2)
"DOMAIN_MIN 0.0 0.3 0.6"
"DOMAIN_MAX 1.0 1.5 2.0"

# LUT_3D_INPUT_RANGE (2-value: min max)
"LUT_3D_INPUT_RANGE 0.0 1.0"
"LUT_3D_INPUT_RANGE -1.0 2.0"
"LUT_3D_INPUT_RANGE 0.0"

# ═══════════════════════════════════════════════════════════════════
# SECTION 6: Comment and whitespace tokens
# ═══════════════════════════════════════════════════════════════════
"# "
"#"
"# Comment text"
"#comment"

# ═══════════════════════════════════════════════════════════════════
# SECTION 7: Title variations — exercise getTitle() quoted/unquoted
# ═══════════════════════════════════════════════════════════════════
"TITLE \"Test LUT\""
"TITLE \"Quoted Title\""
"TITLE Unquoted Title"
"TITLE \"\""
"TITLE "

# ═══════════════════════════════════════════════════════════════════
# SECTION 8: getNext() parser edge cases (whitespace delimited)
# ═══════════════════════════════════════════════════════════════════
# Multiple spaces between values
"0.0  0.0  0.0"
# Leading spaces
" 0.0 0.0 0.0"
# Trailing spaces
"0.0 0.0 0.0 "
# Tab characters (not handled as whitespace by getNext — only spaces)
# Single value (getNext returns empty → parse error path)
"0.5"
# Two values only (second getNext fails → parse error)
"0.5 0.5"

# ═══════════════════════════════════════════════════════════════════
# SECTION 9: Line boundary (MAX_LINE_LEN = 255)
# ═══════════════════════════════════════════════════════════════════
# Long line — exercises the n<MAX_LINE_LEN loop limit
"TITLE \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\""

# ═══════════════════════════════════════════════════════════════════
# SECTION 10: Data line detection (first char triggers fseek break)
# ═══════════════════════════════════════════════════════════════════
# Lines starting with digit/dot/minus trigger break out of header
"0"
"."
"-"
".5 .5 .5"
"-0.5 0.0 1.0"

# ═══════════════════════════════════════════════════════════════════
# SECTION 11: Complete mini-CUBE files — exercise full pipeline
# ═══════════════════════════════════════════════════════════════════
# Minimal valid 2x2x2 CUBE (8 entries)
# With custom domain
# With title and comments
# With video range flags

# --- added by convert-libfuzzer-dict.py ---
"\x06\x00\x00\x00\x00\x00\x00\x00"
"\x01\x00\x00\x00\x00\x00\x00\x00"
"\x01\x00\x7fvW\x93Q\xda"
">\x00\x00\x00\x00\x00\x00\x00"
"\x00\x00\x00\xff"
"\xff\x0d"
"\x00\x00\x7fvWT\xeet"
"\x08\x00"
"A\x00\x00\x00"
