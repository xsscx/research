# ICC Profile Security Analysis Report

**Profile:** `test-profiles/icctoxml-CIccTagXmlColorantTable.icc`
**File Size:** 28346 bytes
**Date:** 2026-02-20
**Analyzer:** iccanalyzer-lite (pre-built binary)

## Exit Code Summary

| Command | Exit Code | Status |
|---------|-----------|--------|
| `iccanalyzer-lite -a` | 0 | [OK] No critical issues detected |
| `iccanalyzer-lite -nf` | 0 | [OK] Raw dump completed |
| `iccanalyzer-lite -r` | 0 | [OK] Round-trip capable |

## Key Findings

- **PROFILE SIZE MISMATCH:** Header declares 8204 bytes (0x0000200C) but actual file is 28346 bytes. The 20142 extra bytes beyond the declared size represent appended data outside the ICC header boundary.
- **TAG TYPE CORRUPTION:** 9 of 10 tags (indices 1-9) have invalid type bytes (0x01010101). The data area for `cprt`, `wtpt`, `rXYZ`, `gXYZ`, `bXYZ`, `rTRC`, `gTRC`, `bTRC`, and `vcgt` is filled with 0x01 bytes, producing `bad-type` signatures.
- **COLORANTTABLE AS DESCRIPTION:** Tag 0 (`profileDescriptionTag`) uses type `clrt` (colorantTableType, 0x636C7274) instead of the expected `mluc` (multiLocalizedUnicodeType). This is the defining characteristic of the `CIccTagXmlColorantTable` test profile.
- **9 SIGNATURE ISSUES DETECTED** (phase 3, all bad-type): indices 1-9 show `Unknown '????' = 01010101 bad-type`.
- **NO ASAN/UBSAN FINDINGS:** No memory safety or undefined behavior errors.
- **ROUND-TRIP CAPABLE:** Matrix/TRC tags allow round-trip validation despite tag type corruption.

## Security Analysis

The profile is a test artifact generated by `iccToXml` exercising the `CIccTagXmlColorantTable` tag class. The structural anomalies are intentional test-profile properties, not attacker-crafted data:

1. The header size field (8204 bytes) does not match the physical file size (28346 bytes). A parser that uses the header size field to bound reads would see a truncated view of the profile. A parser that reads to EOF would see the full file. Neither condition triggers a crash here (exit 0 on all modes), but the mismatch is a latent confusing property.

2. The tag data area from offset 0x0100 onward is populated with 0x01 bytes. This means every tag past the first `desc` entry has a type field reading 0x01010101, which is not a valid ICC tag type. The iccanalyzer-lite correctly identifies all nine as `bad-type` but does not crash â€” it reports 9 signature issues in phase 3 and returns exit 0.

3. The `desc` tag uses `colorantTableType` (`clrt`). This is valid structurally but semantically unusual for a profile description slot. It exercises the `CIccTagXmlColorantTable` XML serialization path.

4. No ASAN or UBSAN output was observed. The profile does not trigger memory safety violations in the current analyzer build.

---

## Command 1: `iccanalyzer-lite -a` (EXIT_CODE=0)

```
=======================================================================
  ICC PROFILE COMPREHENSIVE ANALYSIS (ALL MODES)
=======================================================================

File: /home/runner/work/research/research/test-profiles/icctoxml-CIccTagXmlColorantTable.icc

=======================================================================
PHASE 1: SECURITY HEURISTIC ANALYSIS
=======================================================================


=========================================================================
|              ICC PROFILE SECURITY HEURISTIC ANALYSIS                  |
=========================================================================

File: /home/runner/work/research/research/test-profiles/icctoxml-CIccTagXmlColorantTable.icc

=======================================================================
HEADER VALIDATION HEURISTICS
=======================================================================

[H1] Profile Size: 8204 bytes (0x0000200C)  [actual file: 28346 bytes]
     [OK] Size within normal range

[H2] Magic Bytes (offset 0x24): 61 63 73 70 (acsp)
     [OK] Valid ICC magic signature

[H3] Data ColorSpace: 0x52474220 (RGB )
ICC_DEBUG: [iccDEV/IccProfLib/IccSignatureUtils.h:288] IsValidColorSpaceSignature(): input = 0x52474220 (RGB)
     [OK] Valid colorSpace: RgbData

[H4] PCS ColorSpace: 0x58595A20 (XYZ )
     [OK] Valid PCS: XYZData

[H5] Platform: 0x4150504C (APPL)
     [OK] Known platform code

[H6] Rendering Intent: 0 (0x00000000)
     [OK] Valid intent: Perceptual

[H7] Profile Class: 0x6D6E7472 (mntr)
     [OK] Known class: DisplayClass

[H8] Illuminant XYZ: (0.964203, 1.000000, 0.824905)
     [OK] Illuminant values within physical range

[H15] Date Validation: 2018-06-09 19:43:44
      [OK] Date values within valid ranges

[H16] Signature Pattern Analysis
      [OK] No suspicious signature patterns detected

[H17] Spectral Range Validation
      [OK] No spectral data (standard profile)

=======================================================================
TAG-LEVEL HEURISTICS
=======================================================================

[H9] Critical Text Tags:
     Description: Present [OK]
     Copyright: Present [OK]
     Manufacturer: Missing
     Device Model: Missing

[H10] Tag Count: 10
      [OK] Tag count within normal range

[H11] CLUT Entry Limit Check
      Max safe CLUT entries per tag: 16777216 (16M)
      [OK] Low tag count reduces CLUT exhaustion risk

[H12] MPE Chain Depth Limit
      Max MPE elements per chain: 1024
      Note: Full MPE analysis requires tag-level parsing
      [OK] Limit defined (1024 elements max)

[H13] Per-Tag Size Limit
      Max tag size: 64 MB (67108864 bytes)
      [OK] Theoretical max within limits: 671088640 bytes

[H14] TagArrayType Detection (UAF Risk)
      Checking for TagArrayType (0x74617279 = 'tary')
      Note: Tag signature != tag type - must check tag DATA
      [OK] No TagArrayType tags detected

[H18] Technology Signature Validation
      INFO: No technology tag present

[H19] Tag Offset/Size Overlap Detection
      [OK] No tag overlaps detected

=======================================================================
HEURISTIC SUMMARY
=======================================================================

[OK] NO HEURISTIC WARNINGS DETECTED
  Profile appears well-formed with no obvious security concerns.


=======================================================================
PHASE 2: ROUND-TRIP TAG VALIDATION
=======================================================================


=== Round-Trip Tag Pair Analysis ===
Profile: /home/runner/work/research/research/test-profiles/icctoxml-CIccTagXmlColorantTable.icc

Device Class: 0x6D6E7472

Tag Pair Analysis:
  AToB0/BToA0 (Perceptual):        [ ] [ ]  
  AToB1/BToA1 (Rel. Colorimetric): [ ] [ ]  
  AToB2/BToA2 (Saturation):        [ ] [ ]  

  DToB0/BToD0 (Perceptual):        [ ] [ ]  
  DToB1/BToD1 (Rel. Colorimetric): [ ] [ ]  
  DToB2/BToD2 (Saturation):        [ ] [ ]  

  Matrix/TRC Tags:                 [[X]]  [X] Round-trip capable

[OK] RESULT: Profile supports round-trip validation

Result: Round-trip capable [OK]

=======================================================================
PHASE 3: SIGNATURE ANALYSIS
=======================================================================


=== Signature Analysis ===

Header Signatures:
  Device Class:    0x6D6E7472  ''  DisplayClass
  Color Space:     0x52474220  'RGB '  RgbData
  PCS:             0x58595A20  'XYZ '  XYZData
  Manufacturer:    0x00000000  '....'
  Model:           0x00000000  '....'

Tag Signatures:
Idx  Tag          FourCC     Type         Issues
---  ------------ ---------- ------------ ------
0    profileDescriptionTag 'desc    '  colorantTableType
1    copyrightTag 'cprt    '  Unknown '????' = 01010101 bad-type
2    mediaWhitePointTag 'wtpt    '  Unknown '????' = 01010101 bad-type
3    redColorantTag 'rXYZ    '  Unknown '????' = 01010101 bad-type
4    greenColorantTag 'gXYZ    '  Unknown '????' = 01010101 bad-type
5    blueColorantTag 'bXYZ    '  Unknown '????' = 01010101 bad-type
6    redTRCTag    'rTRC    '  Unknown '????' = 01010101 bad-type
7    greenTRCTag  'gTRC    '  Unknown '????' = 01010101 bad-type
8    blueTRCTag   'bTRC    '  Unknown '????' = 01010101 bad-type
9    Unknown '????' = 01010101 'vcgt    '  Unknown '????' = 01010101 bad-type

Summary: 9 signature issue(s) detected

=======================================================================
PHASE 4: PROFILE STRUCTURE DUMP
=======================================================================

=== ICC Profile Header ===

=== ICC Profile Header (0x0000-0x007F) ===
0x0000: 00 00 20 0C 61 70 70 6C  04 20 00 00 6D 6E 74 72  |.. .appl. ..mntr|
0x0010: 52 47 42 20 58 59 5A 20  07 E2 00 06 00 09 00 13  |RGB XYZ ........|
0x0020: 00 2B 00 2C 61 63 73 70  41 50 50 4C 00 00 00 00  |.+.,acspAPPL....|
0x0030: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
0x0040: 00 00 00 00 00 00 F6 D6  00 01 00 00 00 00 D3 2D  |...............-|
0x0050: 61 70 70 6C 77 BB AE B4  83 2C CE FD 1E 0F AD C7  |applw....,......|
0x0060: B6 57 BD CE 00 00 00 00  00 00 00 00 00 00 00 00  |.W..............|
0x0070: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|

Header Fields:
  Size:            0x0000200C (8204 bytes)
  CMM:             appl
  Version:         0x04200000
  Device Class:    DisplayClass
  Color Space:     RgbData
  PCS:             XYZData

=== Tag Table ===

=== Tag Table ===
Tag Count: 10

Tag Table Raw Data (0x0080-0x00FC):
0x0080: 00 00 00 0A 64 65 73 63  00 00 00 FC 00 00 00 3C  |....desc.......<|
0x0090: 63 70 72 74 00 00 01 38  00 00 00 2E 77 74 70 74  |cprt...8....wtpt|
0x00A0: 00 00 01 68 00 00 00 14  72 58 59 5A 00 00 01 7C  |...h....rXYZ...||
0x00B0: 00 00 00 14 67 58 59 5A  00 00 01 90 00 00 00 14  |....gXYZ........|
0x00C0: 62 58 59 5A 00 00 01 A4  00 00 00 14 72 54 52 43  |bXYZ........rTRC|
0x00D0: 00 00 01 B8 00 00 08 0C  67 54 52 43 00 00 09 C4  |........gTRC....|
0x00E0: 00 00 08 0C 62 54 52 43  00 00 11 D0 00 00 08 0C  |....bTRC........|
0x00F0: 76 63 67 74 00 00 19 DC  00 00 06 30              |vcgt.......0|

Tag Entries:
Idx  Signature    FourCC       Offset     Size
---  ------------ ------------ ---------- ----
0    profileDescriptionTag 'desc      '  0x000000FC  60
1    copyrightTag 'cprt      '  0x00000138  46
2    mediaWhitePointTag 'wtpt      '  0x00000168  20
3    redColorantTag 'rXYZ      '  0x0000017C  20
4    greenColorantTag 'gXYZ      '  0x00000190  20
5    blueColorantTag 'bXYZ      '  0x000001A4  20
6    redTRCTag    'rTRC      '  0x000001B8  2060
7    greenTRCTag  'gTRC      '  0x000009C4  2060
8    blueTRCTag   'bTRC      '  0x000011D0  2060
9    Unknown 'vcgt' = 76636774 'vcgt      '  0x000019DC  1584

=======================================================================
COMPREHENSIVE ANALYSIS SUMMARY
=======================================================================

File: /home/runner/work/research/research/test-profiles/icctoxml-CIccTagXmlColorantTable.icc
Total Issues Detected: 0

[OK] ANALYSIS COMPLETE - No critical issues detected
  Profile appears well-formed.

profiling: /build/iccanalyzer-lite/IccAnalyzerCallGraph.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerComprehensive.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerConfig.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerErrors.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerInspect.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerLUT.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerNinja.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerSecurity.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerSignatures.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerValidation.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerXMLExport.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/iccAnalyzer-lite.gcda: cannot open: No such file or directory
EXIT_CODE=0
```

---

## Command 2: `iccanalyzer-lite -nf` (EXIT_CODE=0)

Note: Full output is 138 KB (1854 lines). The header, tag table, and first 256 bytes of the hex dump are shown below; the remainder is a repetitive 0x01-byte fill spanning the bulk of the file body.

```
=========================================================================
|                   *** REDUCED SECURITY MODE ***                       |
|                                                                       |
|             Copyright (c) 2021-2026 David H Hoyt LLC                 |
|                          hoyt.net                                     |
=========================================================================

WARNING: Analyzing malformed/corrupted ICC profile without validation.
         This mode bypasses all safety checks and may expose parser bugs.
         Use only for security research, fuzzing, or forensic analysis.

File: /home/runner/work/research/research/test-profiles/icctoxml-CIccTagXmlColorantTable.icc
Mode: FULL DUMP (entire file will be displayed)

Raw file size: 28346 bytes (0x6EBA)

=== RAW HEADER DUMP (0x0000-0x007F) ===
0x0000: 00 00 20 0C 61 70 70 6C  04 20 00 00 6D 6E 74 72  |.. .appl. ..mntr|
0x0010: 52 47 42 20 58 59 5A 20  07 E2 00 06 00 09 00 13  |RGB XYZ ........|
0x0020: 00 2B 00 2C 61 63 73 70  41 50 50 4C 00 00 00 00  |.+.,acspAPPL....|
0x0030: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
0x0040: 00 00 00 00 00 00 F6 D6  00 01 00 00 00 00 D3 2D  |...............-|
0x0050: 61 70 70 6C 77 BB AE B4  83 2C CE FD 1E 0F AD C7  |applw....,......|
0x0060: B6 57 BD CE 00 00 00 00  00 00 00 00 00 00 00 00  |.W..............|
0x0070: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|

Header Fields (RAW - no validation):
  Profile Size:    0x0000200C (8204 bytes) MISMATCH
  CMM:             0x6170706C  'appl'
  Version:         0x04200000
  Device Class:    0x6D6E7472  'mntr'
  Color Space:     0x52474220  'RGB '
  PCS:             0x58595A20  'XYZ '

=== RAW TAG TABLE (0x0080+) ===
Tag Count: 10 (0x0000000A)

Tag Table Raw Data:
0x0080: 00 00 00 0A 64 65 73 63  00 00 00 FC 00 00 00 3C  |....desc.......<|
0x0090: 63 70 72 74 00 00 01 38  00 00 00 2E 77 74 70 74  |cprt...8....wtpt|
0x00A0: 00 00 01 68 00 00 00 14  72 58 59 5A 00 00 01 7C  |...h....rXYZ...||
0x00B0: 00 00 00 14 67 58 59 5A  00 00 01 90 00 00 00 14  |....gXYZ........|
0x00C0: 62 58 59 5A 00 00 01 A4  00 00 00 14 72 54 52 43  |bXYZ........rTRC|
0x00D0: 00 00 01 B8 00 00 08 0C  67 54 52 43 00 00 09 C4  |........gTRC....|
0x00E0: 00 00 08 0C 62 54 52 43  00 00 11 D0 00 00 08 0C  |....bTRC........|
0x00F0: 76 63 67 74 00 00 19 DC  00 00 06 30              |vcgt.......0|

Tag Entries (RAW - no validation):
Idx  Signature    FourCC       Offset       Size         TagType      Status
---  ------------ ------------ ------------ ------------ ------------ ------
0    0x64657363   'desc'        0x000000FC   0x0000003C   'clrt'        OK
1    0x63707274   'cprt'        0x00000138   0x0000002E   ''        OK
2    0x77747074   'wtpt'        0x00000168   0x00000014   ''        OK
3    0x7258595A   'rXYZ'        0x0000017C   0x00000014   ''        OK
4    0x6758595A   'gXYZ'        0x00000190   0x00000014   ''        OK
5    0x6258595A   'bXYZ'        0x000001A4   0x00000014   ''        OK
6    0x72545243   'rTRC'        0x000001B8   0x0000080C   ''        OK
7    0x67545243   'gTRC'        0x000009C4   0x0000080C   ''        OK
8    0x62545243   'bTRC'        0x000011D0   0x0000080C   ''        OK
9    0x76636774   'vcgt'        0x000019DC   0x00000630   ''        OK

=== FULL FILE HEX DUMP (all 28346 bytes) ===
0x0000: 00 00 20 0C 61 70 70 6C  04 20 00 00 6D 6E 74 72  |.. .appl. ..mntr|
0x0010: 52 47 42 20 58 59 5A 20  07 E2 00 06 00 09 00 13  |RGB XYZ ........|
0x0020: 00 2B 00 2C 61 63 73 70  41 50 50 4C 00 00 00 00  |.+.,acspAPPL....|
0x0030: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
0x0040: 00 00 00 00 00 00 F6 D6  00 01 00 00 00 00 D3 2D  |...............-|
0x0050: 61 70 70 6C 77 BB AE B4  83 2C CE FD 1E 0F AD C7  |applw....,......|
0x0060: B6 57 BD CE 00 00 00 00  00 00 00 00 00 00 00 00  |.W..............|
0x0070: 00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
0x0080: 00 00 00 0A 64 65 73 63  00 00 00 FC 00 00 00 3C  |....desc.......<|
0x0090: 63 70 72 74 00 00 01 38  00 00 00 2E 77 74 70 74  |cprt...8....wtpt|
0x00A0: 00 00 01 68 00 00 00 14  72 58 59 5A 00 00 01 7C  |...h....rXYZ...||
0x00B0: 00 00 00 14 67 58 59 5A  00 00 01 90 00 00 00 14  |....gXYZ........|
0x00C0: 62 58 59 5A 00 00 01 A4  00 00 00 14 72 54 52 43  |bXYZ........rTRC|
0x00D0: 00 00 01 B8 00 00 08 0C  67 54 52 43 00 00 09 C4  |........gTRC....|
0x00E0: 00 00 08 0C 62 54 52 43  00 00 11 D0 00 00 08 0C  |....bTRC........|
0x00F0: 76 63 67 74 00 00 19 DC  00 00 06 30 63 6C 72 74  |vcgt.......0clrt|
0x0100: 00 00 00 00 00 00 00 01  01 01 01 01 01 01 01 01  |................|
[... 0x01-byte fill continues through 0x6EBA (28346 bytes total) ...]

=== NINJA MODE ANALYSIS COMPLETE ===
Raw data inspection complete. No validation performed.
Use this information for debugging malformed profiles.

profiling: /build/iccanalyzer-lite/IccAnalyzerCallGraph.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerComprehensive.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerConfig.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerErrors.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerInspect.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerLUT.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerNinja.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerSecurity.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerSignatures.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerValidation.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerXMLExport.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/iccAnalyzer-lite.gcda: cannot open: No such file or directory
EXIT_CODE=0
```

---

## Command 3: `iccanalyzer-lite -r` (EXIT_CODE=0)

```
=== Round-Trip Tag Pair Analysis ===
Profile: /home/runner/work/research/research/test-profiles/icctoxml-CIccTagXmlColorantTable.icc

Device Class: 0x6D6E7472

Tag Pair Analysis:
  AToB0/BToA0 (Perceptual):        [ ] [ ]  
  AToB1/BToA1 (Rel. Colorimetric): [ ] [ ]  
  AToB2/BToA2 (Saturation):        [ ] [ ]  

  DToB0/BToD0 (Perceptual):        [ ] [ ]  
  DToB1/BToD1 (Rel. Colorimetric): [ ] [ ]  
  DToB2/BToD2 (Saturation):        [ ] [ ]  

  Matrix/TRC Tags:                 [[X]]  [X] Round-trip capable

[OK] RESULT: Profile supports round-trip validation

profiling: /build/iccanalyzer-lite/IccAnalyzerCallGraph.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerComprehensive.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerConfig.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerErrors.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerInspect.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerLUT.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerNinja.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerSecurity.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerValidation.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/IccAnalyzerXMLExport.gcda: cannot open: No such file or directory
profiling: /build/iccanalyzer-lite/iccAnalyzer-lite.gcda: cannot open: No such file or directory
EXIT_CODE=0
```
